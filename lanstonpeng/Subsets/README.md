##implement a non-recursive version
